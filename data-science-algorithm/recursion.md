# 재귀 알고리즘

## 재귀란?

어떤 문제를 해결하기 위해 알고리즘을 설계할 때 동일한 문제의 조금 더 작은 경우를 해결하므로써 그 문제를 해결하는 것이다. 문제가 간단해져서 바로 풀 수 있는 문제로 작아질 때까지 말이다. 이런 테크닉을 재귀라고 한다.

## 팩토리얼 함수

n 의 팩토리얼은 n!이라고 표시한다. 이는 1 부터 n 까지의 정수를 곱하는 단순한 연산이다. 예를 들어 5!는 1*2*3*4*5, 즉 120 이다.

**얼마나 다양한 방법이 있는지 구할 때**
팩토리얼 함수는 사물의 순서를 정할 때 얼마나 많은 방법이 있는지, 또 어떤 것들을 조합할 때 얼마나 다양한 방법이 있는지 구할 때 매우 유용하다. 예를 들어 n 개의 물건을 배열하는 방법은 몇 개나 될까? 첫 번째 물건을 배열하는 방법은 n 가지 이다. 이런 각각의 n 개의 선택에 대해, 두 번쨰 항목은 n - 1 개의 선택을 할 수 있다. 그러므로 첫 번째와 두 번째 물건을 차례대로 배열하는 방법은 n\*(n - 1)가지이다. 마지막으로 한 가지만 남을 때까지 계속 하면 이를 간단히 n!(n 팩토리얼)로 표현할 수 있다.

**여러 개 중에서 몇 개만 선택하는 경우의 수를 셀 때**
팩토리얼 함수가 유용한 또 다른 예는 여러 개 중에서 몇 개만 선택하는 경우의 수를 셀 때 이다. 예를 들어 여행을 갈 때 가져갈 티셔츠를 고른다고 하면, 티셔츠가 n 개 있지만 그 중 k 개만 가져갈 수 있다고 하자. n 장의 티셔츠 중 k 개의 티셔츠를 고를 수 있는 가지수는 얼마나 될까?
해답은 n!/(k!\*(n - k)!)이다.

팩토리얼 함수는 모든 양의 정수와 0 에 대해 정의된다. 0!의 값은 무엇이어야할까? 이는 1 보다 크거나 같고 0 보다 작거나 같은 모든 정수들의 곱이다. 그렇지만 그런 정수는 존재하지 않는다. 그러므로 0!은 곱셈의 항등원인 1 과 같다고 정의한다. (0!0!=1) 이라고 정의하는 것은 n 가지 중 k 개를 고르는 문제를 위한 공식에 적합하다.
n 개 중에서 n 개를 고르는 방법이 얼마나 있는지 알고 싶다고 하자. 한가지이다. 그럼 n!/(n!*(n - n)!)은 1 이 되어야 한다. 그런데 (n - n)!은 0 이다. 이제 n!/(n!*0)은 1 이 되어야 한다. n!을 분자와 분수에서 모두 약분하면 1/(0!)이 1 이 되어야 한다. 실제로 0! = 1 이기 때문이다.

n !은 n = 0 일 때는 1 이다. n 이 양수일 때는 1•2•••(n -1)•n 과 같다.

## 응용: 반복적인 팩토리얼

```js
const factorial = function(n) {
  let result = 1;
  for (let i = n; i > 0; i--) {
    result *= i;
  }
  return result;
};
```

## 응용: 재귀 팩토리얼

```js
const factorial = function(n) {
  return n === 0 ? 1 : n * factorial(n - 1);
};
```

```js
const factorial = function(n) {
  if (n === 0) {
    return 1;
  }
  return n * factorial(n - 1);
};
```

## 재귀 알고리즘의 속성

> 어떤 문제를 해결하기 위해, 문제의 범위보다 약간 좁은 하위 문제를 해결한다. 그 다음에 하위 문제에 대한 해답을 이용하여 원래 문제를 해결한다.

n!을 계산할 때 n!을 바로 계산하는 대신 이보다 더 작은 (n -1)!(범위가 더 좁은 하위 문제)를 계산하였고, 이에 대한 해답을 이용하여 n!의 값을 계산하였다.

재귀 알고리즘이 실제로 작동하려면 범위가 더 좁은 하위 문제가 base case 에 도달하여 재귀함수가 끝날 수 있어야 한다. n!계산할 때, 하위 문제는 점점 작아져 0!에 도달한다. 이런 base case 가 반드시 있어야 한다.

만약에 n 의 값이 음수가 아니라고 해도 하위 문제의 값을 점점 작아지도록 만들지 않으면 절대로 답을 구할 수 없다.

재귀의 반복 개념은 다음과 같이 두 개의 간단한 규칙으로 간추릴 수 있다.

1. 재귀의 호출은 같은 문제 내에서 더 범위가 작은 값, 즉 하위 문제에 대해 이루어져야 한다.
2. 재귀 함수 호출은 더이상 반복되지 않은 base case 에 도달해야 한다.

## 재귀를 활용하여 회문인지 판단하기

회문(palindrome)은 앞에서 읽는 철자와 뒤에서 읽는 철자가 똑같은 단어이다. 예를들면 rotor 은 회문이지만 motor 은 회문이 아니다.

재귀를 활용하여 회문인지 판단하기

**탈출 조건**

- 빈 문자열이거나 글자가 하나인 문자열
- 첫 번째와 마지막 글자가 같지 않을 때 -> 회문일 수 없음 -> 탈출 조건

첫 번 째와 마지막 글자가 다르면 그 문자열은 회문이 아니다. 그러면 첫 번째와 마지막 글자를 제외하고 남은 문자열-하위문제-가 회문인지 알아보자.
짧아진 문자열의 해답이 원래 문자열의 해답이 되도록 하자. 더 이상 비교할 글자가 없거나 하나만 남게 되면 그 문자열은 회문이다.

**의사 코드(Psudocode)**

- 문자열에 글자가 없거나 하나의 글자만 있다면 회문이다.
- 그 밖의 경우에는, 문자열의 첫 번째 글자와 마지막 글자를 비교한다.
- 첫 번째 글자와 마지막 글자가 서로 다르면 회문이 아니다.
- 그렇지 않다면 첫 번째 글자와 마지막 글자는 서로 같다. 회문일 수도 있고 아닐 수도 있다.
- 그 두 글자를 문자열에서 삭제 한 후 남은 문자열이 회문인지 확인한다.

## 응용: 문자열이 회문일까요?

```js
isPalindrome = function(str) {
  if (str.length <= 1) {
    return true;
  }
  if (str.slice(0, 1) === str.slice(-1)) {
    return isPalindrome(str(1, -1));
  } else {
    return false;
  }
};
```

## 숫자의 거듭제곱 계산하기

- 탈출 조건은 n = 0 이고 x^0 = 1 일 경우이다.
- n 이 양수이고 짝이수이면 y = x^n/2 을 재귀적으로 계산한 후 x^n = y\*y 를 계산한다.
  x^n/2 을 한 번만 계산하고, 이 재귀 호출의 결과를 그 자신과 곱함으로써 단 한번의 재귀 호출만 해도 된다.
- n 이 양수이고 홀수이면 n^n-1 을 재귀적으로 계산하여 지수가 0 이거나 양수이면서 짝수가 되게 한다. 그러면 x^n = x^n-1\*x 가 된다.
- n 이 음수미면 x^-n 을 재귀적으로 계산하여 지수가 양수가 되도록 한다. 그러면 x^n = 1/x^-n 이 된다.

## 응용: 재귀를 활용한 거듭제곱

```js
const power = function(x, n) {
  if (n === 0) {
    return 1;
  } else if (n < 0) {
    return 1 / power(x, -n);
  } else if (n % 2 === 0) {
    y = power(x, n / 2);
    return y * y;
  } else {
    return x * power(x, n - 1);
  }
};
```

## 시어핀스키 가스켓

이제까지 살펴본 재귀의 예에서는 계산할 때마다 재귀 호출을 한 번 해야 했다. 그렇지만 때때로 여러 번 재귀 호출을 해야 할 때도 있다.
시어판스키 가스켓(Sierpinski Gasket)이라고 알려진 프랙탈 구조이다.

![시어판스키 가스켓](https://ka-perseus-images.s3.amazonaws.com/dfd834ca82cc24414aec63f2c86dc9690b19d840.jpg)

어떤 정사각형 영역에 특정 패턴으로 조그만 정사각형들을 계속 그려 넣은 것이다.

**시어핀스키 가스켓을 그리는 방법**

- 정사각형을 얼마나 작게 할 지 정한다. 탈출 조건에 해당할 만큼 작다면 정사각형을 채운다. 얼마나 작은 것이 탈출 조건에 해당하는지는 정할 수 있다.
- 탈출 조건에 해당할 만큼 작지 않다면, 정사각형을 왼쪽 위, 오른쪽 위, 오른쪽 아래, 왼쪽 아래로 나누어 준다. 그 다음 하위 문제 세 개를 해결한다.
  - 왼쪽 위 정사각형에 시어핀스키 가스켓을 그린다.
  - 오른쪽 위 정사각형에 시어핀스키 가스켓을 그린다.
  - 오른쪽 아래 정사각형에 시어핀스키 가스켓을 그린다.

재귀 호출을 한 번이 아닌 세 번해야 한다. 여러 번 재귀 호출을 하는 예로 시어핀스키 가스켓을 사용하는 이유이다.
